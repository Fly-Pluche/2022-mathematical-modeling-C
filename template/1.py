
        \section*{附录}
        \subsection*{图表数据}

        \subsubsection*{第一问化学成分的共线性诊断图表}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (1).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (2).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (3).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (4).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (5).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (6).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (7).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (8).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (9).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (10).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (11).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (12).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (13).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (14).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (15).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (16).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (17).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (18).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (19).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (20).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (21).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (22).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (23).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (24).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (25).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}
        \begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (26).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}\begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (27).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}\begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (28).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}\begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (29).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}\begin{figure}[H]\centering
            \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1 (30).png} % 图片相对位置 
            \caption{共线性诊断} % 图片标题 
        \end{figure}

        \subsubsection*{第一问的化学成分之间的统计规律所得的岭回归方程}

        \noindent\textbf{铅钡}


        \noindent $y0 = 0.034 - 0.366 * x0 - 0.113 * x1 - 0.238 * x2 + 0.231 * x3 - 0.066 * x4 - 0.108 * x5 - 0.037 * x6 - 0.666 * x7 - 0.131 * x8 - 0.188 * x9 + 0.072 * x10 + 0.009 * x11 + 0.028 * x12 + 0.013 * x14$

        \noindent $y1 = 0.004 - 0.041 * x0 - 0.138 * x4 - 0.077 * x13 + 0.29 * x1 + 0.45 * x2 - 0.008 * x3 - 0.058 * x6 - 0.306 * x7 - 0.173 * x8 + 0.12 * x9 - 0.001 * x10 + 0.137 * x11 - 0.08 * x12 + 0.01 * x14$

        \noindent $y2 = 0.047 - 0.582 * x7 - 0.671 * x0 - 0.019 * x13 + 0.043 * x1 - 0.091 * x2 - 0.107 * x3 - 0.1 * x4 - 0.033 * x5 + 0.233 * x6 - 0.101 * x9 + 0.023 * x10 + 0.046 * x11 + 0.12 * x12 - 0.001 * x14$

        \noindent$y3 = -0.001 - 0.344 * x0 - 0.078 * x13 + 0.097 * x2 + 0.238 * x3 + 0.247 * x4 + 0.283 * x5 - 0.104 * x6 + 0.121 * x7 + 0.216 * x8 - 0.083 * x9 - 0.172 * x10 - 0.058 * x11 + 0.025 * x12 + 0.009 * x14$

        \noindent$y4 = 0.013 + 0.055 * x0 + 0.272 * x2 + 0.064 * x13 + 0.094 * x1 + 0.136 * x4 - 0.004 * x5 - 0.062 * x6 - 0.239 * x7 - 0.218 * x8 + 0.136 * x9 + 0.149 * x10 + 0.066 * x11 - 0.062 * x12 - 0.001 * x14$

        \noindent$y5 = -0.0 - 0.46 * x0 + 0.067 * x9 + 0.017 * x13 - 0.058 * x1 - 0.104 * x2 + 0.126 * x3 + 0.093 * x4 - 0.001 * x5 + 0.075 * x6 + 0.648 * x7 + 0.041 * x8 + 0.009 * x11 + 0.041 * x12 + 0.007 * x14$

        \noindent$y6 = 0.054 - 0.867 * x0 - 0.042 * x11 + 0.04 * x13 + 0.051 * x1 + 0.366 * x2 - 0.32 * x3 - 0.25 * x4 - 0.159 * x5 - 0.517 * x6 - 1.359 * x7 + 1.243 * x8 + 0.169 * x9 + 0.249 * x10 - 0.004 * x14$

        \noindent$y7 = 0.069 - 0.801 * x0 - 0.338 * x8 - 0.088 * x13 - 0.056 * x1 + 0.295 * x2 + 0.233 * x3 - 0.052 * x4 + 0.079 * x5 + 0.047 * x6 - 0.721 * x7 + 0.134 * x10 - 0.128 * x11 + 0.056 * x12 - 0.014 * x14$

        \noindent$y8 = 0.021 - 0.558 * x0 + 0.027 * x1 - 0.047 * x13 + 0.194 * x3 + 0.129 * x4 + 0.124 * x5 + 0.04 * x6 + 0.156 * x7 - 0.129 * x8 + 0.123 * x9 - 0.089 * x10 + 0.038 * x11 + 0.051 * x12 - 0.001 * x14$

        \noindent$y9 = 0.046 - 0.058 * x6 - 0.472 * x0 - 0.027 * x13 + 0.007 * x1 + 0.032 * x2 - 0.034 * x3 - 0.129 * x4 - 0.017 * x5 - 0.164 * x8 - 0.06 * x9 + 0.11 * x10 - 0.019 * x11 - 0.038 * x12 - 0.005 * x14$

        \noindent$y10 = 0.038 - 0.496 * x0 - 0.045 * x5 - 0.02 * x13 - 0.084 * x1 + 0.114 * x2 - 0.125 * x3 - 0.059 * x4 - 0.827 * x7 + 0.953 * x8 + 0.056 * x9 + 0.179 * x10 - 0.145 * x11 - 0.205 * x12 - 0.002 * x14$

        \noindent$y11 = 0.036 + 0.07 * x0 + 0.129 * x3 - 0.018 * x13 + 0.093 * x1 + 0.171 * x2 - 0.051 * x5 - 0.027 * x6 - 0.857 * x7 - 0.191 * x8 - 0.03 * x9 + 0.106 * x10 + 0.143 * x11 - 0.046 * x12 - 0.003 * x14$

        \noindent$y12 = 0.027 + 0.086 * x0 + 0.035 * x10 + 0.008 * x13 - 0.073 * x1 + 0.168 * x2 + 0.211 * x3 + 0.482 * x4 + 0.168 * x5 - 0.226 * x6 - 0.406 * x7 + 0.292 * x8 - 0.238 * x9 - 0.026 * x12 - 0.011 * x14$

        \noindent$y13 = 0.033 - 0.014 * x13 - 0.018 * x1 - 0.105 * x2 + 0.008 * x3 + 0.011 * x4 - 0.002 * x5 - 0.033 * x6 - 0.444 * x7 - 0.177 * x8 - 0.063 * x9 - 0.072 * x10 + 0.004 * x11 - 0.023 * x12 + 0.004 * x14$

        \noindent\textbf{高钾}




        \noindent$y0 = 0.138 - 1.883 * x0 + 0.434 * x1 + 0.434 * x2 - 0.458 * x3 + 0.669 * x4 + 0.009 * x5 - 0.001 * x6 + 0.3 * x7 - 0.12 * x8 + 0.033 * x9 - 0.202 * x10 + 0.024 * x11 + 0.092 * x12 - 0.024 * x14$

        \noindent$y1 = 0.113 - 0.044 * x4 - 1.444 * x0 + 0.006 * x13 - 0.19 * x1 + 0.6 * x2 + 0.119 * x3 + 0.138 * x6 - 0.121 * x7 - 0.018 * x8 + 0.381 * x9 + 0.251 * x10 - 0.032 * x11 - 0.19 * x12 - 0.014 * x14$

        \noindent$y2 = 0.023 + 0.361 * x7 - 0.669 * x0 - 0.113 * x13 + 0.358 * x1 - 0.133 * x2 + 0.121 * x3 - 0.183 * x4 - 0.023 * x5 + 0.762 * x6 - 0.057 * x9 + 0.476 * x10 - 0.122 * x11 - 0.2 * x12 + 0.001 * x14$

        \noindent$y3 = 0.027 + 0.09 * x13 - 0.759 * x0 + 0.149 * x2 - 0.019 * x3 + 0.013 * x4 - 0.047 * x5 + 0.041 * x6 - 0.013 * x7 + 0.076 * x8 - 0.048 * x9 + 0.051 * x10 + 0.054 * x11 + 0.098 * x12 + 0.031 * x14$

        \noindent$y4 = 0.083 + 0.066 * x2 - 1.109 * x0 - 0.251 * x13 + 0.077 * x5 - 0.054 * x1 + 0.642 * x4 - 0.062 * x6 - 0.026 * x7 + 0.069 * x8 + 0.0 * x9 + 0.117 * x10 + 0.133 * x11 + 0.07 * x12 - 0.003 * x14$

        \noindent$y5 = 0.024 + 0.24 * x9 - 0.422 * x0 - 0.134 * x13 + 0.164 * x1 - 0.27 * x2 + 0.139 * x3 + 0.294 * x4 + 0.198 * x5 - 0.1 * x6 + 0.088 * x7 + 0.326 * x8 + 0.072 * x11 + 0.182 * x12 - 0.007 * x14$

        \noindent$y6 = 0.127 - 1.108 * x0 - 0.104 * x11 + 0.12 * x13 + 0.637 * x1 + 0.557 * x2 + 0.174 * x3 - 0.1 * x4 - 0.31 * x5 - 0.338 * x6 - 0.173 * x7 - 0.285 * x8 - 0.144 * x9 + 0.376 * x10 - 0.016 * x14$

        \noindent$y7 = 0.008 - 0.365 * x0 + 0.031 * x13 - 0.2 * x1 - 0.48 * x2 + 0.002 * x3 + 0.705 * x4 - 0.05 * x8 + 0.392 * x5 + 0.036 * x6 - 0.179 * x7 + 0.316 * x10 + 0.023 * x11 - 0.092 * x12 + 0.026 * x14$

        \noindent$y8 = 0.074 + 0.221 * x1 + 0.131 * x13 - 1.148 * x0 + 0.039 * x3 + 0.012 * x4 + 0.228 * x5 + 0.159 * x6 + 0.011 * x7 - 0.043 * x8 - 0.177 * x9 - 0.129 * x10 - 0.041 * x11 + 0.127 * x12 + 0.013 * x14$

        \noindent$y9 = 0.055 - 0.347 * x0 - 0.428 * x6 + 0.379 * x13 - 0.076 * x1 + 0.038 * x2 - 0.06 * x3 + 0.2 * x4 - 0.187 * x5 + 0.485 * x8 - 0.265 * x9 + 0.173 * x10 + 0.105 * x11 - 0.165 * x12 + 0.007 * x14$

        \noindent$y10 = 0.133 - 1.087 * x0 - 0.0 * x13 + 0.068 * x5 + 0.078 * x1 + 0.216 * x2 - 0.047 * x3 - 0.317 * x4 - 0.142 * x7 + 0.337 * x8 + 0.018 * x9 - 0.064 * x10 - 0.042 * x11 - 0.104 * x12 - 0.006 * x14$

        \noindent$y11 = 0.059 - 0.644 * x0 + 0.213 * x3 + 0.122 * x13 + 0.01 * x1 + 0.008 * x2 - 0.011 * x5 - 0.137 * x6 + 0.028 * x7 - 0.034 * x8 + 0.148 * x9 + 0.081 * x10 - 0.09 * x11 - 0.013 * x12 + 0.011 * x14$

        \noindent$y12 = 0.072 + 0.517 * x10 - 0.89 * x0 + 0.119 * x13 + 1.215 * x1 - 0.627 * x2 + 1.147 * x3 - 2.323 * x4 - 0.182 * x5 - 0.48 * x6 + 0.387 * x7 - 0.592 * x8 + 0.124 * x9 - 0.36 * x12 + 0.062 * x14$

        \noindent$y13 = 0.079 - 0.022 * x13 - 0.042 * x1 - 0.042 * x2 - 0.023 * x3 - 0.041 * x4 - 0.02 * x5 - 0.03 * x6 - 0.003 * x7 - 0.008 * x8 - 0.005 * x9 - 0.007 * x10 - 0.002 * x11 - 0.009 * x12 - 0.003 * x14$


\subsubsection*{第二问的分类规律}

\begin{table}[H]
    \centering
    \caption{无风化铅钡}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.733     & 0.267       & 15.84\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.94      & 0.06        & 3.56\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.947     & 0.053       & 3.15\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.852     & 0.148       & 8.76\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.924     & 0.076       & 4.53\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.836     & 0.164       & 9.74\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.908     & 0.092       & 5.45\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.904     & 0.096       & 5.70\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.763     & 0.237       & 14.05\% \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.823     & 0.177       & 10.50\% \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.933     & 0.067       & 3.95\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.919     & 0.081       & 4.79\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.948     & 0.052       & 3.08\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.884     & 0.116       & 6.89\%  \\ \hline
    \end{tabular}
\end{table}


\begin{table}[H]
    \centering
    \caption{风化铅钡}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.953     & 0.047       & 3.90\%  \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.944     & 0.056       & 4.57\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.891     & 0.109       & 8.99\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.924     & 0.076       & 6.26\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.908     & 0.092       & 7.55\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.918     & 0.082       & 6.76\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.895     & 0.105       & 8.62\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.965     & 0.035       & 2.88\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.911     & 0.089       & 7.34\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.825     & 0.175       & 14.41\% \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.836     & 0.164       & 13.52\% \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.909     & 0.091       & 7.51\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.969     & 0.031       & 2.54\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.937     & 0.063       & 5.16\%  \\ \hline
    \end{tabular}
\end{table}

\begin{table}[H]
    \centering
    \caption{无风化高钾}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.654     & 0.346       & 15.56\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.914     & 0.086       & 3.88\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.73      & 0.27        & 12.14\% \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.922     & 0.078       & 3.51\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.9       & 0.1         & 4.51\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.771     & 0.229       & 10.29\% \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.853     & 0.147       & 6.59\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.858     & 0.142       & 6.40\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.804     & 0.196       & 8.81\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.855     & 0.145       & 6.52\%  \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.812     & 0.188       & 8.45\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.891     & 0.109       & 4.92\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.926     & 0.074       & 3.31\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.886     & 0.114       & 5.12\%  \\ \hline
    \end{tabular}
\end{table}

\begin{table}[H]
    \centering
    \caption{风化高钾}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.576     & 0.424       & 12.29\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.688     & 0.312       & 9.03\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.657     & 0.343       & 9.95\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.843     & 0.157       & 4.55\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.888     & 0.112       & 3.25\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.804     & 0.196       & 5.68\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.832     & 0.168       & 4.88\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.786     & 0.214       & 6.19\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.705     & 0.295       & 8.55\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.713     & 0.287       & 8.33\%  \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.808     & 0.192       & 5.56\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.756     & 0.244       & 7.08\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.798     & 0.202       & 5.85\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.696     & 0.304       & 8.80\%  \\ \hline
    \end{tabular}
\end{table}

\subsubsection*{第三问的亚分类结果}

\begin{table}[H]
    \centering
    \caption{第二问亚分类结果}
    \begin{tabular}{|l|l|l|}
        \hline
        文物采样点   & 类型 & 聚类类别 \\ \hline
        07           & 高钾 & 2        \\ \hline
        09           & 高钾 & 2        \\ \hline
        10           & 高钾 & 2        \\ \hline
        12           & 高钾 & 2        \\ \hline
        22           & 高钾 & 2        \\ \hline
        27           & 高钾 & 2        \\ \hline
        01           & 高钾 & 1        \\ \hline
        03部位1      & 高钾 & 2        \\ \hline
        03部位2      & 高钾 & 1        \\ \hline
        04           & 高钾 & 1        \\ \hline
        05           & 高钾 & 1        \\ \hline
        06部位1      & 高钾 & 3        \\ \hline
        06部位2      & 高钾 & 3        \\ \hline
        13           & 高钾 & 1        \\ \hline
        14           & 高钾 & 1        \\ \hline
        16           & 高钾 & 1        \\ \hline
        18           & 高钾 & 0        \\ \hline
        02           & 铅钡 & e        \\ \hline
        08           & 铅钡 & d        \\ \hline
        08严重风化点 & 铅钡 & c        \\ \hline
        11           & 铅钡 & a        \\ \hline
        19           & 铅钡 & a        \\ \hline
        26           & 铅钡 & d        \\ \hline
        26严重风化点 & 铅钡 & c        \\ \hline
        34           & 铅钡 & b        \\ \hline
        36           & 铅钡 & b        \\ \hline
        38           & 铅钡 & b        \\ \hline
        39           & 铅钡 & b        \\ \hline
        40           & 铅钡 & b        \\ \hline
        41           & 铅钡 & e        \\ \hline
        43部位1      & 铅钡 & a        \\ \hline
        43部位2      & 铅钡 & a        \\ \hline
        48           & 铅钡 & e        \\ \hline
        49           & 铅钡 & e        \\ \hline
        50           & 铅钡 & a        \\ \hline
        50未风化点   & 铅钡 & a        \\ \hline
    \end{tabular}
\end{table}


\begin{table}[H]
    \centering
    \caption{第二问亚分类结果}
    \begin{tabular}{|l|l|l|}
        \hline
        文物采样点   & 类型 & 聚类类别 \\ \hline
        51部位1      & 铅钡 & e        \\ \hline
        51部位2      & 铅钡 & a        \\ \hline
        52           & 铅钡 & a        \\ \hline
        54           & 铅钡 & a        \\ \hline
        54严重风化点 & 铅钡 & a        \\ \hline
        56           & 铅钡 & b        \\ \hline
        57           & 铅钡 & b        \\ \hline
        58           & 铅钡 & a        \\ \hline
        20           & 铅钡 & c        \\ \hline
        23未风化点   & 铅钡 & c        \\ \hline
        24           & 铅钡 & d        \\ \hline
        25未风化点   & 铅钡 & c        \\ \hline
        28未风化点   & 铅钡 & c        \\ \hline
        29未风化点   & 铅钡 & c        \\ \hline
        30部位1      & 铅钡 & e        \\ \hline
        30部位2      & 铅钡 & e        \\ \hline
        31           & 铅钡 & c        \\ \hline
        32           & 铅钡 & c        \\ \hline
        33           & 铅钡 & c        \\ \hline
        35           & 铅钡 & c        \\ \hline
        37           & 铅钡 & c        \\ \hline
        42未风化点1  & 铅钡 & c        \\ \hline
        42未风化点2  & 铅钡 & c        \\ \hline
        44未风化点   & 铅钡 & c        \\ \hline
        45           & 铅钡 & c        \\ \hline
        46           & 铅钡 & c        \\ \hline
        47           & 铅钡 & c        \\ \hline
        49未风化点   & 铅钡 & c        \\ \hline
        53未风化点   & 铅钡 & c        \\ \hline
        55           & 铅钡 & c        \\ \hline
    \end{tabular}
\end{table}

\subsubsection*{第四问灰色关联结果}
\begin{minipage}{\textwidth}
    \begin{minipage}[t]{0.48\textwidth}
        \makeatletter\def\@captype{table}
        \caption{高钾玻璃-二氧化硅灰色关联度}
        ~~~~~~~~~~~~~~~~\begin{tabular}{|c|c|c|}
            \hline
            评价项   & 关联度 & 排名 \\ \hline
            $x_{2}$  & 0.812  & 4    \\ \hline
            $x_{3}$  & 0.758  & 9    \\ \hline
            $x_{4}$  & 0.748  & 12   \\ \hline
            $x_{5}$  & 0.832  & 3    \\ \hline
            $x_{6}$  & 0.834  & 2    \\ \hline
            $x_{7}$  & 0.807  & 5    \\ \hline
            $x_{8}$  & 0.757  & 10   \\ \hline
            $x_{9}$  & 0.754  & 11   \\ \hline
            $x_{10}$ & 0.793  & 6    \\ \hline
            $x_{11}$ & 0.708  & 13   \\ \hline
            $x_{12}$ & 0.759  & 8    \\ \hline
            $x_{13}$ & 0.856  & 1    \\ \hline
            $x_{14}$ & 0.761  & 7    \\ \hline
        \end{tabular}
        \label{sample-table}
    \end{minipage}
    \begin{minipage}[t]{0.48\textwidth}
        \makeatletter\def\@captype{table}
        \caption{铅钡玻璃-二氧化硅灰色关联度}
        ~~~~~~~~~~~~~~~~\begin{tabular}{|c|c|c|}
            \hline
            评价项   & 关联度 & 排名 \\ \hline
            $x_{2}$  & 0.812  & 4    \\ \hline
            $x_{3}$  & 0.758  & 9    \\ \hline
            $x_{4}$  & 0.748  & 12   \\ \hline
            $x_{5}$  & 0.832  & 3    \\ \hline
            $x_{6}$  & 0.834  & 2    \\ \hline
            $x_{7}$  & 0.807  & 5    \\ \hline
            $x_{8}$  & 0.757  & 10   \\ \hline
            $x_{9}$  & 0.754  & 11   \\ \hline
            $x_{10}$ & 0.793  & 6    \\ \hline
            $x_{11}$ & 0.708  & 13   \\ \hline
            $x_{12}$ & 0.759  & 8    \\ \hline
            $x_{13}$ & 0.856  & 1    \\ \hline
            $x_{14}$ & 0.761  & 7    \\ \hline
        \end{tabular}
    \end{minipage}
\end{minipage}
~\\
\subsubsection*{第四问灰色关联散点图}
\begin{table}[H]
    \centering
    \caption{无风化铅钡熵权法}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.733     & 0.267       & 15.84\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.94      & 0.06        & 3.56\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.947     & 0.053       & 3.15\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.852     & 0.148       & 8.76\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.924     & 0.076       & 4.53\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.836     & 0.164       & 9.74\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.908     & 0.092       & 5.45\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.904     & 0.096       & 5.70\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.763     & 0.237       & 14.05\% \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.823     & 0.177       & 10.50\% \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.933     & 0.067       & 3.95\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.919     & 0.081       & 4.79\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.948     & 0.052       & 3.08\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.884     & 0.116       & 6.89\%  \\ \hline
    \end{tabular}
\end{table}
\begin{table}[H]
    \centering
    \caption{风化铅钡熵权法}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.953     & 0.047       & 3.90\%  \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.944     & 0.056       & 4.57\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.891     & 0.109       & 8.99\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.924     & 0.076       & 6.26\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.908     & 0.092       & 7.55\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.918     & 0.082       & 6.76\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.895     & 0.105       & 8.62\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.965     & 0.035       & 2.88\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.911     & 0.089       & 7.34\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.825     & 0.175       & 14.41\% \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.836     & 0.164       & 13.52\% \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.909     & 0.091       & 7.51\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.969     & 0.031       & 2.54\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.937     & 0.063       & 5.16\%  \\ \hline
    \end{tabular}
\end{table}
\begin{table}[H]
    \centering
    \caption{无风化高钾熵权法}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.654     & 0.346       & 15.56\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.914     & 0.086       & 3.88\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.73      & 0.27        & 12.14\% \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.922     & 0.078       & 3.51\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.9       & 0.1         & 4.51\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.771     & 0.229       & 10.29\% \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.853     & 0.147       & 6.59\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.858     & 0.142       & 6.40\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.804     & 0.196       & 8.81\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.855     & 0.145       & 6.52\%  \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.812     & 0.188       & 8.45\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.891     & 0.109       & 4.92\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.926     & 0.074       & 3.31\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.886     & 0.114       & 5.12\%  \\ \hline
    \end{tabular}
\end{table}
\begin{table}[H]
    \centering
    \caption{风化高钾熵权法}
    \begin{tabular}{|l|l|l|l|}
        \hline
        熵权法                          & ~         & ~           & ~       \\ \hline
        项                              & 信息熵值e & 信息效用值d & 权重    \\ \hline
        二氧化硅(SiO2)\_min-max标准化   & 0.576     & 0.424       & 12.29\% \\ \hline
        氧化钠(Na2O)\_min-max标准化     & 0.688     & 0.312       & 9.03\%  \\ \hline
        氧化钾(K2O)\_min-max标准化      & 0.657     & 0.343       & 9.95\%  \\ \hline
        氧化钙(CaO)\_min-max标准化      & 0.843     & 0.157       & 4.55\%  \\ \hline
        氧化镁(MgO)\_min-max标准化      & 0.888     & 0.112       & 3.25\%  \\ \hline
        氧化铝(Al2O3)\_min-max标准化    & 0.804     & 0.196       & 5.68\%  \\ \hline
        氧化铁(Fe2O3)\_min-max标准化    & 0.832     & 0.168       & 4.88\%  \\ \hline
        氧化铜(CuO)\_min-max标准化      & 0.786     & 0.214       & 6.19\%  \\ \hline
        氧化铅(PbO)\_min-max标准化      & 0.705     & 0.295       & 8.55\%  \\ \hline
        氧化钡(BaO)\_min-max标准化      & 0.713     & 0.287       & 8.33\%  \\ \hline
        五氧化二磷(P2O5)\_min-max标准化 & 0.808     & 0.192       & 5.56\%  \\ \hline
        氧化锶(SrO)\_min-max标准化      & 0.756     & 0.244       & 7.08\%  \\ \hline
        氧化锡(SnO2)\_min-max标准化     & 0.798     & 0.202       & 5.85\%  \\ \hline
        二氧化硫(SO2)\_min-max标准化    & 0.696     & 0.304       & 8.80\%  \\ \hline
    \end{tabular}
\end{table}
\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/1.png} % 图片相对位置 
    \caption{氧化钠散点图} % 图片标题 
\end{figure}
\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/2.png} % 图片相对位置 
    \caption{氧化钾散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/3.png} % 图片相对位置 
    \caption{氧化钙散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/4.png} % 图片相对位置 
    \caption{氧化镁散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/5.png} % 图片相对位置 
    \caption{氧化铝散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/6.png} % 图片相对位置 
    \caption{氧化铁散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/7.png} % 图片相对位置 
    \caption{氧化铜散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/8.png} % 图片相对位置 
    \caption{氧化铅散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/9.png} % 图片相对位置 
    \caption{氧化钡散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/10.png} % 图片相对位置 
    \caption{五氧化二磷散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/11.png} % 图片相对位置 
    \caption{氧化锶散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/12.png} % 图片相对位置 
    \caption{氧化锡散点图} % 图片标题 
\end{figure}\begin{figure}[H]\centering
    \includegraphics[width=1\textwidth,height=0.6\textwidth]{img/13.png} % 图片相对位置 
    \caption{二氧化硫散点图} % 图片标题 
\end{figure}


\clearpage

% \newpage %参考文献完后重启一页




% \clearpage
% \bibliographystyle{plain}
% \bibliography{ref}%ref指向自己创建的ref.bib
% % IoU\cite{zheng2020distance}
% \clearpage

%最后一部分
% \section{附录}
\subsection*{代码}

\lstset{language=Python}
\begin{lstlisting}
	# %%
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

from lightgbm import LGBMClassifier

from mlxtend.classifier import StackingClassifier
from mlxtend.classifier import StackingCVClassifier

from sklearn.svm import SVC
from sklearn import metrics

from sklearn.ensemble import VotingClassifier
from sklearn.ensemble import AdaBoostClassifier as ada
from sklearn.ensemble import GradientBoostingClassifier
from sklearn.ensemble import RandomForestClassifier as RF

from sklearn.model_selection import GridSearchCV
from sklearn.model_selection import cross_val_score
from sklearn.model_selection import train_test_split

from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression

from sklearn.metrics import roc_auc_score, precision_score, recall_score

# %% [markdown]
#

# %%
#  Voting
data = pd.read_excel(
    'D://workspace//mathematical_modeling//CUMCM2022//solver//excel//extract//3//data_merage.xlsx'
)
# data = pd.read_csv('D://workspace//mathematical_modeling//test_2//solver//excel//extract//1//第一问特征提取.csv',
#                    encoding='utf-8',
#                    index_col='企业代号')
data = data.fillna('0')
data

# %%
data.describe()

# %%
x = data.loc[:, '二氧化硅(SiO2)':'量化风化']
print(x.shape)
print(x)

# %%
y = data.loc[:, 'label']
print(y.shape)
print(y)

# %%
x_train, x_test, y_train, y_test = train_test_split(x,
                                                    y,
                                                    test_size=0.3,
                                                    train_size=0.7,
                                                    random_state=20,
                                                    shuffle=True)

# (x - u) / s  归一化
tranfer = StandardScaler()
x = tranfer.fit_transform(x)
x_train = tranfer.transform(x_train)
x_test = tranfer.transform(x_test)
print(x.shape)
print(x_train.shape)
print(x_test.shape)

# %%
# init model

LR = LogisticRegression(C=0.2,
                        class_weight=None,
                        dual=False,
                        fit_intercept=True,
                        intercept_scaling=1,
                        l1_ratio=None,
                        max_iter=100,
                        multi_class='auto',
                        n_jobs=None,
                        penalty='l2',
                        random_state=None,
                        solver='newton-cg',
                        tol=0.0001,
                        verbose=0,
                        warm_start=False)
Ada = ada(algorithm='SAMME',
          base_estimator=None,
          learning_rate=0.1,
          n_estimators=100,
          random_state=30)
GBDT = GradientBoostingClassifier(ccp_alpha=0.0,
                                  criterion='friedman_mse',
                                  init=None,
                                  learning_rate=0.7,
                                  loss='exponential',
                                  max_depth=3,
                                  max_features='auto',
                                  max_leaf_nodes=None,
                                  min_impurity_decrease=0.0,
                                  min_samples_leaf=1,
                                  min_samples_split=2,
                                  min_weight_fraction_leaf=0.0,
                                  n_estimators=25,
                                  n_iter_no_change=None,
                                  random_state=30,
                                  subsample=1.0,
                                  tol=0.0001,
                                  validation_fraction=0.1,
                                  verbose=0,
                                  warm_start=False)
svc = SVC(C=0.1, kernel='linear', probability=True)
# break_ties=False, cache_size=10, class_weight=None, coef0=0.1,
#     decision_function_shape='ovr', degree=3, gamma=2, kernel='rbf',
#     max_iter=-1, probability=True, random_state=None, shrinking=True, tol=0.001,
#     verbose=False)

rf = RF(bootstrap=True,
        ccp_alpha=0.0,
        class_weight=None,
        criterion='gini',
        max_depth=None,
        max_features='auto',
        max_leaf_nodes=None,
        max_samples=None,
        min_impurity_decrease=0.0,
        min_samples_leaf=1,
        min_samples_split=2,
        min_weight_fraction_leaf=0.0,
        n_estimators=100,
        n_jobs=None,
        oob_score=False,
        random_state=30,
        verbose=0,
        warm_start=False)

#cv：设定交叉验证折数
sclf = StackingCVClassifier(classifiers=[Ada, GBDT, LR, rf],
                            use_probas=True,
                            meta_classifier=svc,
                            random_state=30,
                            cv=5)

# lightGBM适合较大数据集的样本
# 而对于较小的数据集(<10000条记录)，lightGBM可能不是最佳选择。所以，如果进行调优lightgbm参数，这可能没有帮助。
lgb = LGBMClassifier(learning_rate=0.6,
                     n_estimators=20,
                     objective='binary',
                     boosting_type='gbdt',
                     num_leaves=2**5,
                     max_depth=5,
                     reg_alpha=0.5,
                     reg_lambda=0.5,
                     metric='auc',
                     subsample=0.75)

metric_xlsx = {}
weight = []
for clf, label in zip(
    [LR, Ada, GBDT, svc, rf, sclf, lgb],
    ['LR', 'Ada', 'GBDT', 'svc', 'rf', 'StackingClassifier', 'LGBMClassifier'
     ]):
    clf.fit(x_train, y_train)
    y_predict = clf.predict(x_test)

    tem_1 = [
        metrics.accuracy_score(y, clf.predict(x)),
        metrics.accuracy_score(y_train, clf.predict(x_train)),
        metrics.accuracy_score(y_test, y_predict),
        precision_score(y_test, y_predict),
        recall_score(y_test, y_predict),
        metrics.roc_auc_score(y_test,
                              clf.predict_proba(x_test)[:, 1]),
        metrics.f1_score(y_test, y_predict),
    ]
    metric_xlsx[label] = tem_1
    # tem = metrics.accuracy_score(y, clf.predict(x))
    weight.append(tem_1[0])

data2 = pd.DataFrame(data=metric_xlsx,
                     index=[
                         'total_Accuracy', 'train_Accuracy', 'test_Accuracy',
                         'Precision', 'Recall', 'AUC', 'f1'
                     ]).T

data2.to_excel('./excel/result/3/model_metric.xlsx')
data2

# %%

print(len(weight))
print(weight)

# 软投票
# w = weight/sum(weight)

vote2 = VotingClassifier(estimators=[('LR', LR), ('Ada', Ada), ('GBDT', GBDT),
                                     ('SVC', svc), ('rf', rf),
                                     ('StackingClassifier', sclf),
                                     ('LGBMClassifier', lgb)],
                         voting='soft',
                         weights=weight)
vote2.fit(x_train, y_train)
y_predict = vote2.predict(x_test)

print('soft voting的综合表现:\n', metrics.accuracy_score(y, vote2.predict(x)))
print('{}在测试集集模型的准确率为：\n'.format('soft Voting'),
      metrics.accuracy_score(y_test, y_predict))
print('{}在训练集模型的准确率为：\n'.format('soft Voting'),
      metrics.accuracy_score(y_train, vote2.predict(x_train)))
print('soft voting的ROC面积：\n', roc_auc_score(y, vote2.predict(x)))
print('soft voting的Precision：\n', precision_score(y_test, y_predict))
print('soft voting的Recall：\n', recall_score(y_test, y_predict))
print('soft voting的F1：\n', metrics.f1_score(y_test, y_predict))

# %%
P = vote2.predict_proba(x)[:, 1]
fpr, tpr, threshold = metrics.roc_curve(y, P)
# 计算AUC的值
roc_auc = metrics.auc(fpr, tpr)

#绘制面积图
plt.figure(figsize=(6, 4), dpi=250)
plt.stackplot(fpr, tpr, color='steelblue', alpha=0.5, edgecolor='black')
# 添加边际线
plt.plot(fpr, tpr, color='black', lw=1)
# 添加对角线
plt.plot([0, 1], [0, 1], color='red', linestyle='--')
# 添加文本信息
plt.text(0.5, 0.3, 'ROC curve (area = %0.4f)' % roc_auc, fontsize=10)
# 添加x轴坐标与y轴坐标
plt.xlabel('1-Specificity')
plt.ylabel('Sensitivity')

fpr, tpr, threshold = metrics.roc_curve(y, P)
# 计算AUC的值
print('AUC的值为：', roc_auc)
plt.savefig('./excel/result/3/AUC.png')
plt.show()

# %% [markdown]
# ## 通过上面的实验，我们发现，模型预测效果好，泛化性强。由于训练数据较少，为了提高模型的训练泛化性已经鲁棒性，故此本文使用全部的数据集进行训练（原本只使用训练集）

# %%
vote2 = VotingClassifier(estimators=[('LR', LR), ('Ada', Ada), ('GBDT', GBDT),
                                     ('SVC', svc), ('rf', rf),
                                     ('StackingClassifier', sclf),
                                     ('LGBMClassifier', lgb)],
                         voting='soft',
                         weights=weight)
vote2.fit(x, y)
y_predict = vote2.predict(x)
cm = metrics.confusion_matrix(y, y_predict)
print('soft voting的综合表现:\n', metrics.accuracy_score(y, y_predict))
print()
print('soft voting的ROC面积：\n', roc_auc_score(y, y_predict))
print(cm)

TP = cm[0][0]
FN = cm[0][1]
FP = cm[1][0]
TN = cm[1][1]
print('TP:', TP)
print('FP:', FP)
print('FP:', FP)
print('TN:', TN)
# 灵敏度
SE = TP / (TP + FN)

# 特异性
SP = TN / (TN + FP)
print('灵敏度', SE)
print('特异性', SP)

\end{lstlisting}


\end{document}
